{% extends "layout/layout_auth.html" %}

{% load i18n %}
{% block page_title %}
ØªØ§ÛŒÛŒØ¯ Ø­Ø³Ø§Ø¨
{% endblock page_title %}

{% block container %}



<h4 class="mb-1 pt-2">ØªØ§ÛŒÛŒØ¯ Ø¯Ùˆ Ù…Ø±Ø­Ù„Ù‡ Ø§ÛŒ ğŸ’¬</h4>
<p class="text-start mb-4"> Ù…Ø§ ÛŒÚ© Ú©Ø¯ ØªØ£ÛŒÛŒØ¯ Ø¨Ù‡ ØªÙ„ÙÙ† Ù‡Ù…Ø±Ø§Ù‡ Ø´Ù…Ø§ Ø§Ø±Ø³Ø§Ù„ Ú©Ø±Ø¯ÛŒÙ…. Ú©Ø¯ ØªØ§ÛŒÛŒØ¯ Ø§Ø±Ø³Ø§Ù„ Ø´Ø¯Ù‡ Ø±Ø§ Ø¯Ø± ÙÛŒÙ„Ø¯ Ø²ÛŒØ± ØªØ§ÛŒÙ¾ Ú©Ù†ÛŒØ¯.
    <span class="fw-medium d-block mt-2">
        <bdi>{{phone_first}}***{{phone_last}}</bdi>
    </span>
</p>
<p class="mb-0 fw-medium">Ú©Ø¯ Ø§Ù…Ù†ÛŒØªÛŒ 6 Ø±Ù‚Ù…ÛŒ</p>
<form action="" id="twoStepsForm" method="POST" class='fv-plugins-bootstrap5 fv-plugins-framework'
    novalidate='novalidate'>
    {% csrf_token %}
    <div class="mb-3">
        <div class="auth-input-wrapper d-flex align-items-center justify-content-sm-between numeral-mask-wrapper ltr">
            {{form.num1}}
            {{form.num2}}
            {{form.num3}}
            {{form.num4}}
            {{form.num5}}
            {{form.num6}}
        </div>
        <!-- Create a hidden field which is combined by 3 fields above -->
        <input name="otp" type="hidden" />
        <p>Ù„Ø·ÙØ§Ù‹ ØªØ§ <span id="timer" class="fw-bold">2:00</span> ØµØ¨Ø± Ú©Ù†ÛŒØ¯.</p>
    </div>
    <button class="btn btn-primary d-grid w-100 mb-3">ØªØ§ÛŒÛŒØ¯ Ø­Ø³Ø§Ø¨ Ú©Ø§Ø±Ø¨Ø±ÛŒ</button>
    <div id="resend" class="text-center" style='display:none'> Ú©Ø¯ Ø±Ø§ Ø¯Ø±ÛŒØ§ÙØª Ù†Ú©Ø±Ø¯ÛŒØ¯ØŸ
        <a id='resendBtn' href='' onclick="resend()"> Ø§Ø±Ø³Ø§Ù„ Ù…Ø¬Ø¯Ø¯</a>
    </div>
</form>









<script>
    function nextInput(element) {
        let input = document.getElementById(element.id).value;
        if (input.length == 1) {
            let get_id = parseInt(element.id[6], 10);
            get_id = get_id + 1;
            if (get_id <= 6) {
                document.getElementById(`id_num${get_id}`).focus();
            }
        }

    }


</script>


{% endblock container %}


{% block page_js %}

<script>
    let seconds = "{{expire}}";

    const count_down = document.getElementById('timer');
    const resendBtn = document.getElementById('resendBtn');

    function updateTimer() {
        const now = Date.now();
        const diff = Math.floor((seconds - now) / 1000);

        if (diff > 0) {
            count_down.textContent = `Ø§Ø±Ø³Ø§Ù„ Ù…Ø¬Ø¯Ø¯ ØªØ§ ${diff} Ø«Ø§Ù†ÛŒÙ‡`;
        } else {
            count_down.textContent = 'Ø²Ù…Ø§Ù† Ø¨Ù‡ Ù¾Ø§ÛŒØ§Ù† Ø±Ø³ÛŒØ¯';
            document.getElementById('resend').style.display = 'inline-block';
            resendBtn.style.display = 'inline-block';
            clearInterval(timer);
        }
    }

    const timer = setInterval(updateTimer, 1000);
    updateTimer();


</script>



<script>
    function resend() {
        $.get("{% url 'resend' phone %}", function (data) {

            if (data['status'] == 200) {
                Swal.fire({ title: data['message'], icon: "success", draggable: false, }).then((result) => {
                    window.location.reload();

                })

            }
        });
    }

</script>







{% endblock page_js %}